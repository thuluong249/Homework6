var uv,searchHistory=[];const apiKey="&appid=afaa8eea1769b4359fd8e07b2efcefbd";let date=new Date;function getCityWeather(t){var a=t;$("#forecastH0","#forecastH1","#forecastH2","#forecastH3","#forecastH4").addClass("show");t="https://api.openweathermap.org/data/2.5/weather?q="+a+apiKey;$.ajax({url:t,method:"GET"}).then(function(t){console.log(t),console.log(t.name),console.log(t.weather[0].icon);var e=1.8*(t.main.temp-273.15)+32;console.log(Math.floor(e)),console.log(t.main.humidity),console.log(t.wind.speed),getCurrentConditions(t),getCurrentForecast(a),searchHistory.includes(a)||(makeList(a),searchHistory.push(a),console.log(searchHistory),saveSearchHistory())})}function makeList(t){var e=t;let a=$("<li>").addClass("list-group-item").text(t);a.on("click",function(){getCityWeather(e)}),$(".list").append(a)}function getCurrentConditions(t){var e=1.8*(t.main.temp-273.15)+32,e=Math.floor(e);$("#currentCity").empty();const a=$("<div>").addClass("card"),r=$("<div>").addClass("card-body"),o=$("<h4>").addClass("card-title").text(t.name);var s=$("<h4>").addClass("card-title").text(date.toLocaleDateString("en-US")),n=$("<p>").addClass("card-text current-temp").text("Temperature: "+e+" °F"),c=$("<p>").addClass("card-text current-humidity").text("Humidity: "+t.main.humidity+"%"),e=$("<p>").addClass("card-text current-wind").text("Wind Speed: "+t.wind.speed+" MPH"),t=$("<img>").attr("src","https://openweathermap.org/img/w/"+t.weather[0].icon+".png");o.append(s,t),r.append(o,n,c,e),a.append(r),$("#currentCity").append(a)}function getUVindex(t,e){$.ajax({url:"https://api.openweathermap.org/data/2.5/onecall?lat="+t+"&lon="+e+apiKey,method:"GET"}).then(function(t){console.log(t),uv=t.current.uvi;const e=$("<p>").addClass("card-text current-uvindex").text("UVIndex: ");t=$("<span>").text(uv);uv<3?$(t).css("background-color","green"):uv<6?$(t).css("background-color","yellow"):uv<10?$(t).css("background-color","red"):$(t).css("background-color","purple"),e.append(t),$("#currentCity .card-body").append(e),$("#uvindex").text("test")})}function getCurrentForecast(t){$.ajax({url:"https://api.openweathermap.org/data/2.5/forecast?q="+t+apiKey,method:"GET"}).then(function(t){getUVindex(t.city.coord.lat,t.city.coord.lon),console.log(t),$("#forecast").empty();let a=t.list;console.log(a);for(let e=0;e<a.length;e++){let t=a[e].dt_txt.slice(0,10);var r=t.split("-");if(t=r[1]+"/"+r[2]+"/"+r[0],-1!==a[e].dt_txt.indexOf("12:00:00")){var o=1.8*(a[e].main.temp-273.15)+32,s=Math.floor(o);const c=$("<div>").addClass("card col-md-2 ml-4 bg-primary text-white"),i=$("<div>").addClass("card-body p-3 forecastBody");var n=$("<h4>").addClass("card-title").text(t),r=$("<p>").addClass("card-text forecastTemp").text("Temperature: "+s+" °F"),o=$("<p>").addClass("card-text forecastHumidity").text("Humidity: "+a[e].main.humidity+"%"),s=$("<img>").attr("src","https://openweathermap.org/img/w/"+a[e].weather[0].icon+".png");i.append(n,s,r,o),c.append(i),$("#forecast").append(c)}}})}function loadSearchHistory(){(searchHistory=JSON.parse(localStorage.getItem("searchHistory"))||[]).forEach(function(t){console.log(t),makeList(t)})}function saveSearchHistory(t){localStorage.setItem("searchHistory",JSON.stringify(searchHistory))}loadSearchHistory(),$("#searchTerm").keypress(function(t){13===t.keyCode&&(t.preventDefault(),$("#searchBtn").click())}),$("#searchBtn").on("click",function(){var t=$("#searchTerm").val();$("#searchTerm").val(""),getCityWeather(t)});